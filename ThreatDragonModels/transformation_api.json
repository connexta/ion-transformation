{
  "summary": {
    "title": "Transformation API"
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "title": "Threat Model",
        "thumbnail": "./public/content/images/thumbnail.jpg",
        "id": 0,
        "$$hashKey": "object:16",
        "diagramJson": {
          "cells": [
            {
              "type": "tm.Actor",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 1,
                "y": 113
              },
              "angle": 0,
              "id": "4e179efa-922e-42ac-8276-27c1f6d8ccde",
              "z": 1,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "(1) Client"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Actor",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 356,
                "y": 187
              },
              "angle": 0,
              "id": "835dc1c6-04ed-4695-a12c-679f1d1b49dc",
              "z": 2,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "DOS From Requests",
                  "type": "Denial of service",
                  "mitigation": "Implement a load balancer.",
                  "description": "Numerous empty requests from users could overburden the API and prevent it from processing valid requests.",
                  "$$hashKey": "object:224"
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "(2) Internal API"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 605,
                "y": 114
              },
              "angle": 0,
              "id": "f23bee0c-9228-4dcf-baeb-2c06ac520370",
              "z": 3,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "(4) Service\nRegistry"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 974,
                "y": 345
              },
              "angle": 0,
              "id": "0d8bccfa-7aa3-47d0-88d4-f31a486ed3b1",
              "z": 4,
              "hasOpenThreats": true,
              "isALog": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "title": "Unauthorized Changes to Database",
                  "description": "Database should only take commands from recognized profiles, namely the Service Registry Service.",
                  "mitigation": "Implement proper permission checks.",
                  "$$hashKey": "object:235"
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "(5) Database"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "4e179efa-922e-42ac-8276-27c1f6d8ccde"
              },
              "target": {
                "id": "835dc1c6-04ed-4695-a12c-679f1d1b49dc"
              },
              "vertices": [
                {
                  "x": 154,
                  "y": 243
                }
              ],
              "id": "b04e0b3e-e7b6-452d-86a7-103951cd2396",
              "labels": [
                {
                  "position": {
                    "distance": 0.47514171310395836,
                    "offset": 0.2076809643767774
                  },
                  "attrs": {
                    "text": {
                      "text": "Transform Request",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 5,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 308,
                "y": 68
              },
              "target": {
                "x": 328,
                "y": 294
              },
              "vertices": [
                {
                  "x": 300,
                  "y": 185
                }
              ],
              "id": "108a4aad-2961-4659-a9aa-fdbe54c65800",
              "z": 6,
              "attrs": {}
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "835dc1c6-04ed-4695-a12c-679f1d1b49dc"
              },
              "target": {
                "id": "4b62febf-9bc2-4154-b052-97415311f1d6"
              },
              "vertices": [
                {
                  "x": 402,
                  "y": 126
                }
              ],
              "id": "cf6ba3ac-305e-4031-8cee-d28c1f95ccb9",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Put Request",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 8,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 1010,
                "y": 192
              },
              "target": {
                "x": 972,
                "y": 535
              },
              "vertices": [
                {
                  "x": 919,
                  "y": 344
                }
              ],
              "id": "16a82c8a-100d-445c-ada3-61350b7a5950",
              "z": 10,
              "attrs": {}
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 618,
                "y": 334
              },
              "angle": 0,
              "id": "5f0267db-508f-4e8c-b337-b357470b9d0b",
              "z": 11,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "See Request Queue",
                  "type": "Denial of service",
                  "description": "Issues for this queue are same as the Request Queue",
                  "mitigation": "Resolve Request Queue threats, then mark this as mitigated.",
                  "$$hashKey": "object:197"
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "(6) Service Queue"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "f23bee0c-9228-4dcf-baeb-2c06ac520370"
              },
              "target": {
                "id": "5f0267db-508f-4e8c-b337-b357470b9d0b"
              },
              "vertices": [],
              "id": "213f2fb7-37c4-4dff-ae3a-519dc0628c26",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Publish Request",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 12,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 521,
                "y": 585
              },
              "angle": 0,
              "id": "0a73588c-dc92-486e-ae50-34cc6cc39c72",
              "z": 14,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "title": "Unauthorized Modifying of NiFi Flow",
                  "description": "If a malicious entity has access to the integration environment, there is no permissions set in place that would prevent them from tampering with the NiFi flow. This would be especially problematic if we pushed changes to the production environment without knowing they existed. \n\nIdeally, the flow should not be modified in integration, or only slightly edited in the case of some attributes.",
                  "mitigation": "Would be useful to have some protection in the form of authentication. Would also be helpful to have a tool to make us aware of changes to the flow in this environment.\nThis might be a good source of info when dealing with this problem:\nhttps://pierrevillard.com/2017/01/24/integration-of-nifi-with-ldap/",
                  "$$hashKey": "object:245"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Location URL Valid but File is Bad",
                  "type": "Denial of service",
                  "description": "Someone making requests could intentionally (or unintentionally) provide a link to a file which, although valid, provides a file which can't be processed. An example would be a file so large that we exceed memory capacity to process it.",
                  "mitigation": "Built-In NiFi processors like SplitText allow us to break down files, but we should be conscious about our system's limits and set a filesize limit if needed.",
                  "$$hashKey": "object:257"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "title": "Unauthorized Replacement of NiFi Instance Inside NiFi Container",
                  "description": "A variation of the threat Unauthorized Modifying of NiFi. Someone gaining access can easily replace the nifi Instance with their own altered version. Similar to the other ticket, these changes could be made with a good probability of not being detected.",
                  "mitigation": "Restrict access to who can enter the container, and further restrict permission to delete the directory/create a new directory.",
                  "$$hashKey": "object:55"
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "(7) NiFi  Transfo\nrmation\nDataflow"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "5f0267db-508f-4e8c-b337-b357470b9d0b"
              },
              "target": {
                "x": 615,
                "y": 599
              },
              "vertices": [],
              "id": "d9f86256-f9c4-4e76-9bbd-0c3b4ce6bb3d",
              "labels": [
                {
                  "position": {
                    "distance": 0.5435713616206024,
                    "offset": -1.6396089978516102
                  },
                  "attrs": {
                    "text": {
                      "text": "Consume Request",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 15,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0a73588c-dc92-486e-ae50-34cc6cc39c72"
              },
              "target": {
                "id": "835dc1c6-04ed-4695-a12c-679f1d1b49dc"
              },
              "vertices": [
                {
                  "x": 460,
                  "y": 369
                }
              ],
              "id": "f588c332-c432-4784-818f-9e16f21fb545",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Success",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 18,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 14,
                "y": 591
              },
              "angle": 0,
              "id": "8d458282-4d31-4003-8580-8e1b2a6fe8f3",
              "z": 20,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "title": "Unauthorized Upload to S3 Buckets",
                  "description": "Someone possessing S3 credentials without permission could upload and download files out of sync with the regular workflow.",
                  "$$hashKey": "object:218",
                  "mitigation": "Enforce specific profiles with permissions to upload or download."
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "(8) Cloud Blob Store"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 202,
                "y": 502
              },
              "target": {
                "x": 185,
                "y": 766
              },
              "vertices": [
                {
                  "x": 226,
                  "y": 634
                }
              ],
              "id": "ed4a63b5-1191-4368-bd83-a84ea6a5d49d",
              "z": 21,
              "attrs": {}
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 341,
                "y": 15
              },
              "angle": 0,
              "id": "4b62febf-9bc2-4154-b052-97415311f1d6",
              "z": 30,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "title": "Multiple Consumers",
                  "description": "If queue info is known, a malicious user could open up a consumer on it, making two consumers on that queue. Multiple consumers will stop the queue from working as expected.",
                  "mitigation": "Something in place that will check/prevent multiple consumers.",
                  "$$hashKey": "object:174"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "DOS from multiple producers",
                  "type": "Denial of service",
                  "description": "Multiple producers to a queue could publish blank objects to it, to the point that the consumer is unable to process them.",
                  "mitigation": "Implement a load balancer.",
                  "$$hashKey": "object:180"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "title": "Gaining Unauthenticated Access to Queue Data",
                  "description": "Entities might gain access to the queue if no credential systems are in place, allowing them to consume data they should not have access to.",
                  "mitigation": "Implement the need for credentials in queues.",
                  "$$hashKey": "object:212"
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "(3) Request Queue"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "4b62febf-9bc2-4154-b052-97415311f1d6"
              },
              "target": {
                "id": "f23bee0c-9228-4dcf-baeb-2c06ac520370"
              },
              "vertices": [],
              "id": "4f8368be-6cd6-4049-b16d-004c150f0290",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Read Request",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 31,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "f23bee0c-9228-4dcf-baeb-2c06ac520370"
              },
              "target": {
                "id": "0d8bccfa-7aa3-47d0-88d4-f31a486ed3b1"
              },
              "vertices": [
                {
                  "x": 840,
                  "y": 133
                }
              ],
              "id": "5abb5f4e-1f34-4056-8b41-f8d9222575ba",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "MIME Type Query",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 32,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0d8bccfa-7aa3-47d0-88d4-f31a486ed3b1"
              },
              "target": {
                "id": "f23bee0c-9228-4dcf-baeb-2c06ac520370"
              },
              "vertices": [],
              "id": "83d64213-9756-429d-9f48-4a18da11bf18",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Query Results",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 33,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 414,
                "y": 709
              },
              "target": {
                "x": 812,
                "y": 638
              },
              "vertices": [
                {
                  "x": 562,
                  "y": 528
                }
              ],
              "id": "f07307ad-665e-43b5-b80f-69253194361c",
              "z": 34,
              "attrs": {}
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0a73588c-dc92-486e-ae50-34cc6cc39c72"
              },
              "target": {
                "id": "8d458282-4d31-4003-8580-8e1b2a6fe8f3"
              },
              "vertices": [],
              "id": "c5ef2454-e614-4731-8478-158c077ef911",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Transform Results",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 35,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0a73588c-dc92-486e-ae50-34cc6cc39c72"
              },
              "target": {
                "id": "4e179efa-922e-42ac-8276-27c1f6d8ccde"
              },
              "vertices": [
                {
                  "x": 200,
                  "y": 430
                }
              ],
              "id": "6df4e498-b392-4b2d-81f6-bea78d157d53",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Callback URL",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 36,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            }
          ]
        },
        "size": {
          "height": 1017,
          "width": 1164
        }
      }
    ]
  }
}
